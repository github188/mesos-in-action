# 持续集成系统维护心得

## 持续集成的交付方式

这里的交付方式指的是开发者将项目以何种方式交付给运维人员，或者项目以何种方式部署到服务器。常见的交付方式有

* 源代码交付
> 源代码交付需要将源代码以 tar 包等方式 download 到服务器，然后在服务器上借助程序的构建脚本去构建可执行程序，显然这种方式会经常因服务器环境差异，构建环境初始化失败等问题导致无法构建可执行程序。严重依赖于构建脚本的完备程度。
* 二进制包交付
> 二进制包交付常见的例子是 Linux 标准包的交付，将项目的依赖通过 Linux deb 或者 rpm 来管理，由于这种方式更符合 Linux 规范，间接的提高了项目在服务器上部署的成功率。
* 虚拟镜像交付
> 虚拟镜像交付指的是我们将项目在虚拟机里测试成功后直接将该虚拟镜像部署到服务器上。显然，这种方式部署成功率接近100%。但是随之而来的问题就是虚拟镜像本身对服务器资源的消耗。
* docker image 交付
> docker image 交付是虚拟镜像交付的进一步演进，在保证系统隔离的同时，docker image 对服务器的资源消耗更低。当然，由于 docker 技术仍在发展之中，docker 本身到稳定性还有待提高。我们团队目前正在使用这种方式进行交付。

## 不同环境下的配置管理

对于一个常规的项目来说，开发环境，测试环境与生产环境的配置是不一样的，譬如，这三种环境需要使用不同的域名等。在以 docker 镜像交付时，我们可以通过环境变量来保证配置的差异性。

## 持续集成可靠性的保证

这里我想阐明的是持续集成本身并不能保证项目的可靠性，持续集成是项目可靠性的一个必要非充分条件。只有为你的项目添加单元测试，集成测试等才能达到更可靠的交付。即，可靠交付的更多人力在提高测试覆盖率。

## js 的配置管理问题

js 代码不同于在服务器端运行的代码，JS 在不同环境下的配置管理需要额外的操作，目前已知有两种：

* 使用初始化脚本动态的替换 JS 配置文件中的关键词，即初始化脚本获取环境变量后动态替换 配置文件中相应的值。
* 使用 URL 匹配，为不同的环境设置不同的URL，譬如测试环境与开发环境的URL分别为：
 
  * 测试环境： http://www.mesos-in-action.com?env=test
  * 开发环境： http://www.mesos-in-action.com?env=devel

从而使用不同的 JS 配置文件。这是 StackOverflow 推荐的一个比较优雅的解决方案。

## 自动生成 ReleaseNote


## html页面加commitid or tag

## irc notification